import{S as z,i as B,s as I,e as J,x as K,c as Q,a as U,y as X,d as L,b as Z,g as ee,z as ae,r as te,p as le,C as se,w as re,$ as he}from"../../chunks/index-5436dd91.js";import{p as W}from"../../chunks/jobs-05b5ef9c.js";import{P as oe,g as G}from"../../chunks/PowerTable-dd35eac1.js";function ne(P){let u,n,k,S={ptData:P[1],ptInstructs:P[2],ptOptions:P[3]};return n=new oe({props:S}),P[5](n),{c(){u=J("div"),K(n.$$.fragment),this.h()},l(r){u=Q(r,"DIV",{class:!0});var c=U(u);X(n.$$.fragment,c),c.forEach(L),this.h()},h(){Z(u,"class","MuonW PowerTable")},m(r,c){ee(r,u,c),ae(n,u,null),k=!0},p(r,[c]){const $={};c&2&&($.ptData=r[1]),c&4&&($.ptInstructs=r[2]),c&8&&($.ptOptions=r[3]),n.$set($)},i(r){k||(te(n.$$.fragment,r),k=!0)},o(r){le(n.$$.fragment,r),k=!1},d(r){r&&L(u),P[5](null),se(n)}}}const N=1,Y=2,F=3;function ie(P,u,n){let k,S=[],r=[],c={};re(()=>{n(1,S=W),n(3,c={userFunctions:{customParse:$},searchPhrase:"/a.*t/gimsu",searchIsRegex:!0,checkboxColumn:!0});let e=[];Object.keys(W[0]).forEach(p=>{e.push({key:p,title:p,parseAs:"unsafe-html"})}),e[4].filterPhrase="man",e[4].filterIsRegex=!1,e[5].filterPhrase="o",e[5].filterIsRegex=!1,n(2,r=e)});function $(e){return e=O(e,k,r),e}let w={[N]:{open:'<span class="search-match">',close:"</span>"},[Y]:{open:'<span class="filter-match">',close:"</span>"},[F]:{open:'<span class="overlap-match">',close:"</span>"}};function O(e,p,R){if(p!=null&&p.getData){let _=H(e,p,R);e=V(e,_,R)}return e}function H(e,p,R){var M,h,f,A,D;let _,C,d={},l=[],T=p.getData();_=(h=(M=T.search)==null?void 0:M.value)!=null?h:"",C=(A=(f=T.search)==null?void 0:f.isRegex)!=null?A:!1,R.forEach(t=>{var E,o,m,y;d[t.key]={value:(o=(E=T.filters[t.key])==null?void 0:E.value)!=null?o:"",isRegex:(y=(m=T.filters[t.key])==null?void 0:m.isRegex)!=null?y:!1}});let i,a;if(_){let t=new RegExp("");if(C===!1){let E=_.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&").trim(),o=E.toLowerCase().match(/\S+/g);o!=null&&o.length&&(E=o.join("|")),t=new RegExp(E,"gi")}else{if(a=G(_),!a)throw new Error("RegEx is not valid!");i=(D=a==null?void 0:a.flags)!=null?D:"",t=new RegExp(a.pattern,i)}e.forEach((E,o)=>{R.forEach((m,y)=>{let s=[];C===!1||(i==null?void 0:i.indexOf("g"))!==-1?s=[...E[m.key].matchAll(t)]:s=[E[m.key].match(t)],s!=null&&s.length&&(l[o]||(l[o]={}),l[o][m.key]||(l[o][m.key]=[]),s.forEach(b=>{if(b)for(let v=b.index;v<b.index+b[0].length;v++)l[o][m.key][v]=N}))})})}let g=new RegExp("");return R.forEach((t,E)=>{var o,m;if((o=d[t.key])!=null&&o.value){if(d[t.key].isRegex===!1){let y=d[t.key].value.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&").trim(),s=y.toLowerCase().match(/\S+/g);s!=null&&s.length&&(y=s.join("|")),g=new RegExp(y,"gi")}else{if(a=G(d[t.key].value),!a)throw new Error("RegEx is not valid!");i=(m=a==null?void 0:a.flags)!=null?m:"",g=new RegExp(a.pattern,i)}e.forEach((y,s)=>{let b=[];d[t.key].isRegex===!1||(i==null?void 0:i.indexOf("g"))!==-1?b=[...y[t.key].matchAll(g)]:b=[y[t.key].match(g)],b.length&&(l[s]||(l[s]={}),l[s][t.key]||(l[s][t.key]=[]),b.forEach(v=>{var j;if(v)for(let x=v.index;x<v.index+v[0].length;x++)(j=l[s][t.key][x])!=null&&j?l[s][t.key][x]=F:l[s][t.key][x]=Y}))})}}),l}function V(e,p,R){let _=[];return e.forEach((C,d)=>{R.forEach(l=>{var T;if(_=(T=p[d])==null?void 0:T[l.key]){let i=-1,a={startChar:-1,endChar:-1,type:-1},g=[],M=0;_.forEach((h,f)=>{i===-1?a={startChar:f,endChar:f,type:h}:f-M>1?(g.push({...a,endChar:M}),a={startChar:f,endChar:f,type:h}):h!=i?(g.push({...a}),a={startChar:f,endChar:f,type:h}):a.endChar=f,i=h,M=f}),a.type>0&&g.push(a),g=g.sort((h,f)=>f.startChar-h.startChar),g.forEach(h=>{C[l.key]=[C[l.key].slice(0,h.startChar),w[h.type].open,C[l.key].slice(h.startChar,h.endChar+1),w[h.type].close,C[l.key].slice(h.endChar+1)].join("")})}})}),e}function q(e){he[e?"unshift":"push"](()=>{k=e,n(0,k)})}return[k,S,r,c,O,q]}class ge extends z{constructor(u){super(),B(this,u,ie,ne,I,{highlighter:4})}get highlighter(){return this.$$.ctx[4]}}export{ge as default};
