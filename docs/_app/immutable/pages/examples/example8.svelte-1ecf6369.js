import{S as z,i as B,s as I,e as J,x as K,c as Q,a as U,y as X,d as L,b as Z,g as ee,z as ae,r as le,p as te,C as se,w as re,$ as he}from"../../chunks/index-5436dd91.js";import{P as oe,p as W,g as G}from"../../chunks/PowerTable-cb0966b3.js";function ne(T){let E,n,k,S={ptData:T[1],ptInstructs:T[2],ptOptions:T[3]};return n=new oe({props:S}),T[5](n),{c(){E=J("div"),K(n.$$.fragment),this.h()},l(r){E=Q(r,"DIV",{class:!0});var c=U(E);X(n.$$.fragment,c),c.forEach(L),this.h()},h(){Z(E,"class","MuonW PowerTable")},m(r,c){ee(r,E,c),ae(n,E,null),k=!0},p(r,[c]){const $={};c&2&&($.ptData=r[1]),c&4&&($.ptInstructs=r[2]),c&8&&($.ptOptions=r[3]),n.$set($)},i(r){k||(le(n.$$.fragment,r),k=!0)},o(r){te(n.$$.fragment,r),k=!1},d(r){r&&L(E),T[5](null),se(n)}}}const N=1,Y=2,F=3;function fe(T,E,n){let k,S=[],r=[],c={};re(()=>{n(1,S=W),n(3,c={userFunctions:{pageMod:$},searchPhrase:"/a.*t/gimsu",searchIsRegex:!0,checkboxColumn:!0});let e=[];Object.keys(W[0]).forEach(p=>{e.push({key:p,title:p,parseAs:"unsafe-html"})}),e[4].filterPhrase="man",e[4].filterIsRegex=!1,e[5].filterPhrase="o",e[5].filterIsRegex=!1,n(2,r=e)});function $(e){return e=O(e,k,r),e}let w={[N]:{open:'<span class="search-match">',close:"</span>"},[Y]:{open:'<span class="filter-match">',close:"</span>"},[F]:{open:'<span class="overlap-match">',close:"</span>"}};function O(e,p,R){if(p!=null&&p.getData){let _=H(e,p,R);e=V(e,_,R)}return e}function H(e,p,R){var M,h,i,A,D;let _,d,C={},t=[],P=p.getData();_=(h=(M=P.search)==null?void 0:M.value)!=null?h:"",d=(A=(i=P.search)==null?void 0:i.isRegex)!=null?A:!1,R.forEach(l=>{var m,o,u,y;C[l.key]={value:(o=(m=P.filters[l.key])==null?void 0:m.value)!=null?o:"",isRegex:(y=(u=P.filters[l.key])==null?void 0:u.isRegex)!=null?y:!1}});let f,a;if(_){let l=new RegExp("");if(d===!1){let m=_.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o=m.toLowerCase().match(/\S+/g);o!=null&&o.length&&(m=o.join("|")),l=new RegExp(m,"gi")}else{if(a=G(_),!a)throw new Error("RegEx is not valid!");f=(D=a==null?void 0:a.flags)!=null?D:"",l=new RegExp(a.pattern,f)}e.forEach((m,o)=>{R.forEach((u,y)=>{let s=[];d===!1||(f==null?void 0:f.indexOf("g"))!==-1?s=[...m[u.key].matchAll(l)]:s=[m[u.key].match(l)],s!=null&&s.length&&(t[o]||(t[o]={}),t[o][u.key]||(t[o][u.key]=[]),s.forEach(b=>{if(b)for(let v=b.index;v<b.index+b[0].length;v++)t[o][u.key][v]=N}))})})}let g=new RegExp("");return R.forEach((l,m)=>{var o,u;if((o=C[l.key])!=null&&o.value){if(C[l.key].isRegex===!1){let y=C[l.key].value.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),s=y.toLowerCase().match(/\S+/g);s!=null&&s.length&&(y=s.join("|")),g=new RegExp(y,"gi")}else{if(a=G(C[l.key].value),!a)throw new Error("RegEx is not valid!");f=(u=a==null?void 0:a.flags)!=null?u:"",g=new RegExp(a.pattern,f)}e.forEach((y,s)=>{let b=[];C[l.key].isRegex===!1||(f==null?void 0:f.indexOf("g"))!==-1?b=[...y[l.key].matchAll(g)]:b=[y[l.key].match(g)],b.length&&(t[s]||(t[s]={}),t[s][l.key]||(t[s][l.key]=[]),b.forEach(v=>{var j;if(v)for(let x=v.index;x<v.index+v[0].length;x++)(j=t[s][l.key][x])!=null&&j?t[s][l.key][x]=F:t[s][l.key][x]=Y}))})}}),t}function V(e,p,R){let _=[];return e.forEach((d,C)=>{R.forEach(t=>{var P;if(_=(P=p[C])==null?void 0:P[t.key]){let f=-1,a={startChar:-1,endChar:-1,type:-1},g=[],M=0;_.forEach((h,i)=>{f===-1?a={startChar:i,endChar:i,type:h}:i-M>1?(g.push({...a,endChar:M}),a={startChar:i,endChar:i,type:h}):h!=f?(g.push({...a}),a={startChar:i,endChar:i,type:h}):a.endChar=i,f=h,M=i}),a.type>0&&g.push(a),g=g.sort((h,i)=>i.startChar-h.startChar),g.forEach(h=>{d[t.key]=[d[t.key].slice(0,h.startChar),w[h.type].open,d[t.key].slice(h.startChar,h.endChar+1),w[h.type].close,d[t.key].slice(h.endChar+1)].join("")})}})}),e}function q(e){he[e?"unshift":"push"](()=>{k=e,n(0,k)})}return[k,S,r,c,O,q]}class pe extends z{constructor(E){super(),B(this,E,fe,ne,I,{highlighter:4})}get highlighter(){return this.$$.ctx[4]}}export{pe as default};
